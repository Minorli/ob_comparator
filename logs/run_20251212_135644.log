2025-12-12 13:56:44,777 [INFO] - 本次运行日志将输出到: /home/minorli/comparator/logs/run_20251212_135644.log
2025-12-12 13:56:44,778 [INFO] - OceanBase Comparator Toolkit v0.8.8
2025-12-12 13:56:44,778 [INFO] - 本次启用的主对象类型: FUNCTION, JOB, MATERIALIZED VIEW, PACKAGE, PACKAGE BODY, PROCEDURE, SCHEDULE, SYNONYM, TABLE, TYPE, TYPE BODY, VIEW
2025-12-12 13:56:44,778 [INFO] - 本次启用的扩展校验: CONSTRAINT, INDEX, SEQUENCE, TRIGGER
2025-12-12 13:56:44,778 [INFO] - 准备使用 Oracle Instant Client 目录: /home/minorli/orabase/instantclient_19_29
2025-12-12 13:56:44,778 [INFO] - 如遇 libnnz19.so 等库缺失，请先执行:
2025-12-12 13:56:44,778 [INFO] -   export LD_LIBRARY_PATH="/home/minorli/orabase/instantclient_19_29:${LD_LIBRARY_PATH}"
2025-12-12 13:56:44,778 [INFO] - 当前 LD_LIBRARY_PATH: /home/minorli/orabase/instantclient_19_29:
2025-12-12 13:56:44,920 [INFO] - 正在加载 Remap 规则文件: remap_rules.txt
2025-12-12 13:56:44,921 [INFO] - 加载了 6 条 Remap 规则。
2025-12-12 13:56:44,921 [INFO] - 正在连接 Oracle 源端: 172.16.0.199:1521/ora19pdb1...
2025-12-12 13:56:44,990 [INFO] - Oracle 连接成功。正在查询源对象列表...
2025-12-12 13:56:45,079 [INFO] - 从 Oracle 成功获取 48 个受管对象 (包含主对象与扩展对象)。
2025-12-12 13:56:45,080 [INFO] - 正在验证 Remap 规则...
2025-12-12 13:56:45,080 [INFO] - Remap 规则验证通过，所有规则中的源对象均存在。
2025-12-12 13:56:45,210 [INFO] - 已获取 33 个依附对象的父表映射（触发器/同义词/索引/约束）。
2025-12-12 13:56:45,490 [INFO] - Oracle 依赖信息加载完成，共 44 条记录。
2025-12-12 13:56:45,491 [INFO] - 正在预计算依赖图的递归 TABLE/MVIEW 引用缓存以加速 remap 推导...
2025-12-12 13:56:45,492 [INFO] - 递归依赖表缓存完成，共 39 个节点。
2025-12-12 13:56:45,572 [INFO] - 已缓存 1 个同义词元数据（OWNER IN ORA_APP,ORA_FIN,ORA_BI,ORA_UTIL，跳过 PUBLIC 系统同义词 0 个）。
2025-12-12 13:56:45,575 [WARNING] - 检测到 PACKAGE/PACKAGE BODY 推导目标不一致 (ORA_APP.PKG_ORDER_API vs OB_SALES.PKG_ORDER_API)，已强制统一为 OB_SALES.PKG_ORDER_API。
2025-12-12 13:56:45,577 [WARNING] - 检测到 PACKAGE/PACKAGE BODY 推导目标不一致 (ORA_BI.PKG_BI_API vs OB_FIN.PKG_BI_API)，已强制统一为 OB_FIN.PKG_BI_API。
2025-12-12 13:56:45,578 [WARNING] - 检测到 TYPE/TYPE BODY 推导目标不一致 (ORA_UTIL.T_ORDER_REC vs OB_SALES.T_ORDER_REC)，已强制统一为 OB_SALES.T_ORDER_REC。
2025-12-12 13:56:45,579 [INFO] - 正在生成主校验清单 (应用 Remap 规则)...
2025-12-12 13:56:45,580 [INFO] - 主校验清单生成完毕，共 31 个待校验项。
2025-12-12 13:56:45,580 [INFO] - Schema映射推导完成，共 3 个源schema:
2025-12-12 13:56:45,581 [INFO] -   ORA_APP -> ORA_APP (1:1或一对多场景)
2025-12-12 13:56:45,581 [INFO] -   ORA_FIN -> OB_FIN
2025-12-12 13:56:45,582 [INFO] -   ORA_UTIL -> ORA_UTIL (1:1或一对多场景)
2025-12-12 13:56:45,582 [INFO] - ================================================================================
2025-12-12 13:56:45,582 [INFO] - 检测到一对多 schema 映射场景（源schema的表分散到多个目标schema）：
2025-12-12 13:56:45,583 [INFO] -   ORA_APP -> ['OB_LOG', 'OB_SALES', 'ORA_APP']
2025-12-12 13:56:45,583 [INFO] - 
2025-12-12 13:56:45,584 [INFO] - 推导策略：
2025-12-12 13:56:45,584 [INFO] -   1. 独立对象（VIEW/PROCEDURE/FUNCTION/PACKAGE等）：
2025-12-12 13:56:45,585 [INFO] -      - 优先通过依赖分析推导（分析对象引用的表，选择出现最多的目标schema）
2025-12-12 13:56:45,585 [INFO] -      - 如果依赖推导失败，需要在 remap_rules.txt 中显式指定
2025-12-12 13:56:45,585 [INFO] -   2. 依附对象（TRIGGER/INDEX/CONSTRAINT/SEQUENCE）：
2025-12-12 13:56:45,586 [INFO] -      - 自动跟随父表的 schema，无需显式指定
2025-12-12 13:56:45,586 [INFO] - ================================================================================
2025-12-12 13:56:45,589 [WARNING] - 检测到 PACKAGE/PACKAGE BODY 推导目标不一致 (ORA_APP.PKG_ORDER_API vs OB_SALES.PKG_ORDER_API)，已强制统一为 OB_SALES.PKG_ORDER_API。
2025-12-12 13:56:45,591 [WARNING] - 检测到 PACKAGE/PACKAGE BODY 推导目标不一致 (ORA_BI.PKG_BI_API vs OB_FIN.PKG_BI_API)，已强制统一为 OB_FIN.PKG_BI_API。
2025-12-12 13:56:45,592 [WARNING] - 检测到 TYPE/TYPE BODY 推导目标不一致 (ORA_UTIL.T_ORDER_REC vs OB_SALES.T_ORDER_REC)，已强制统一为 OB_SALES.T_ORDER_REC。
2025-12-12 13:56:45,592 [INFO] - 正在生成主校验清单 (应用 Remap 规则)...
2025-12-12 13:56:45,593 [INFO] - 主校验清单生成完毕，共 31 个待校验项。
2025-12-12 13:56:45,594 [INFO] - 本次报告将输出到: main_reports/report_20251212_135644.txt
2025-12-12 13:56:45,595 [INFO] - 全量对象映射已输出: main_reports/object_mapping_20251212_135644.txt
2025-12-12 13:56:47,216 [INFO] - [CONSTRAINT] 已忽略 21 条 OceanBase 自动 OBNOTNULL 约束。
2025-12-12 13:56:47,349 [INFO] - OceanBase 元数据转储完成 (根据开关加载 DBA_OBJECTS/列/索引/约束/触发器/序列/注释)。
2025-12-12 13:56:47,630 [INFO] - OceanBase 依赖信息加载完成，共 45 条记录。
2025-12-12 13:56:47,631 [INFO] - 正在批量加载 Oracle 元数据 (DBA_TAB_COLUMNS/DBA_INDEXES/DBA_CONSTRAINTS/DBA_TRIGGERS/DBA_SEQUENCES)...
2025-12-12 13:56:47,936 [INFO] - Oracle 元数据加载完成：列=8, 索引表=8, 约束表=8, 触发器表=4, 序列schema=2, 注释表=8
2025-12-12 13:56:47,937 [INFO] - 检查汇总: 所有关注对象类型的数量与期望一致（不计入额外对象）。
2025-12-12 13:56:47,938 [INFO] - --- 开始执行主对象批量验证 (TABLE/VIEW/PROC/FUNC/PACKAGE/PACKAGE BODY/SYNONYM) ---
2025-12-12 13:56:47,940 [INFO] - --- 开始执行扩展对象校验 (索引/约束/序列/触发器) ---
2025-12-12 13:56:48,096 [INFO] - [GRANT_FILTER] 已过滤 6 条已存在的授权建议。
2025-12-12 13:56:48,098 [INFO] - 依赖链路已输出: main_reports/dependency_chains_20251212_135644.txt
2025-12-12 13:56:48,098 [INFO] - 已开启修补脚本生成，开始写入 fixup_scripts 目录...
2025-12-12 13:56:48,099 [INFO] - [FIXUP] 目标端订正 SQL 将生成到目录: /home/minorli/comparator/fixup_scripts
2025-12-12 13:56:48,100 [INFO] - [FIXUP] 待生成缺失对象/脚本总计 0 个: TABLE=0, 其他=0 (无), INDEX=0, CONSTRAINT=0, SEQUENCE=0, TRIGGER=0
2025-12-12 13:56:48,100 [INFO] - [FIXUP] 进度日志间隔 10 秒，可通过 progress_log_interval 配置。
2025-12-12 13:56:48,101 [INFO] - [FIXUP] 启用并发生成 (worker=8)，可通过 fixup_workers 配置调整。
2025-12-12 13:56:48,101 [INFO] - [FIXUP] (1/9) 正在生成 SEQUENCE 脚本...
2025-12-12 13:56:48,101 [INFO] - [FIXUP] (2/9) 正在生成缺失的 TABLE CREATE 脚本...
2025-12-12 13:56:48,101 [INFO] - [FIXUP] (3/9) 正在生成 TABLE ALTER 脚本...
2025-12-12 13:56:48,132 [INFO] - [VIEW] 检测到OceanBase版本: 4.2.5.7
2025-12-12 13:56:48,133 [INFO] - [FIXUP] (4/9) 正在生成 VIEW / MATERIALIZED VIEW / 其他对象脚本...
2025-12-12 13:56:48,133 [INFO] - [FIXUP] (5/9) 正在生成 INDEX 脚本...
2025-12-12 13:56:48,133 [INFO] - [FIXUP] (6/9) 正在生成 CONSTRAINT 脚本...
2025-12-12 13:56:48,133 [INFO] - [FIXUP] (7/9) 正在生成 TRIGGER 脚本...
2025-12-12 13:56:48,134 [INFO] - [FIXUP] (8/9) 正在生成依赖重编译脚本...
2025-12-12 13:56:48,134 [INFO] - [FIXUP] 生成目标端订正 SQL: fixup_scripts/compile/ORA_UTIL.PKG_UTIL.compile.sql
2025-12-12 13:56:48,135 [INFO] - [FIXUP] (9/9) 无需生成依赖授权脚本。
2025-12-12 13:56:48,135 [INFO] - 所有校验已完成。正在生成最终报告...
